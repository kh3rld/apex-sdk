# cargo-audit configuration for Apex SDK
# https://docs.rs/cargo-audit/latest/cargo_audit/

[advisories]
# Ignore specific advisories (both vulnerabilities and warnings) with documented justification
ignore = [
    # === VULNERABILITIES ===
    
    # ruint 1.17.0 reciprocal_mg10 unsoundness (RUSTSEC-2025-0137)
    # ------------------------------------------------
    # Source: alloy-primitives -> ruint 1.17.0
    # Issue: Unsoundness in safe reciprocal_mg10 function allowing out-of-bounds access
    # Risk Assessment: LOW
    #   - Function not directly used in application code
    #   - Transitive dependency from Alloy ecosystem
    #   - Memory corruption possible if function is called with specific inputs
    # Mitigation Plan:
    #   - Short-term: Updated to latest Alloy v1.2.1 and alloy-primitives v1.5.2
    #   - Monitoring: Waiting for upstream ruint fix
    #   - Long-term: Will update immediately when ruint releases patched version
    # Tracking: https://rustsec.org/advisories/RUSTSEC-2025-0137
    "RUSTSEC-2025-0137",

    # ring 0.16.20 AES panic vulnerability (RUSTSEC-2025-0009)
    # ------------------------------------------------
    # Source: ethers -> ethers-providers -> jsonwebtoken -> ring 0.16.20
    # Issue: AES functions may panic when overflow checking is enabled
    # Risk Assessment: LOW
    #   - Not exploitable in JWT validation context used by ethers
    #   - No QUIC protocol usage in our codebase
    #   - Affects 1 in 2^32 packets, not applicable to our use case
    # Mitigation Plan:
    #   - Short-term: Documented acceptance with low risk
    #   - Long-term: Migration to Alloy (ethers replacement) in v1.0
    # Tracking: Part of Alloy migration roadmap (see PRODUCTION_ROADMAP.md)
    "RUSTSEC-2025-0009",
    
    # === UNMAINTAINED WARNINGS ===

    # ring 0.16.x unmaintained (RUSTSEC-2025-0010)
    # ------------------------------------------------
    # Same dependency chain as RUSTSEC-2025-0009
    # Update: Rustls team now maintains ring for security patches
    # Mitigation: Same as RUSTSEC-2025-0009 - Alloy migration
    "RUSTSEC-2025-0010",

    # fxhash 0.2.1 unmaintained (RUSTSEC-2025-0057)
    # Source: ethers-providers -> hashers -> fxhash
    # Type: Hash function optimization
    # Risk: None - no known vulnerabilities
    # Mitigation: Resolved with Alloy migration
    "RUSTSEC-2025-0057",

    # instant 0.1.13 unmaintained (RUSTSEC-2024-0384)
    # Source: ethers-providers, ethers-middleware -> instant
    # Type: Cross-platform time measurement
    # Risk: None - no security vulnerabilities
    # Mitigation: Resolved with Alloy migration
    "RUSTSEC-2024-0384",

    # derivative 2.2.0 unmaintained (RUSTSEC-2024-0388)
    # ------------------------------------------------
    # Source: sp-core -> ark-* -> derivative
    # Type: Derive macro for custom trait implementations
    # Risk: None - no security vulnerabilities
    # Note: Transitive dependency from Substrate/Polkadot SDK
    # Mitigation: Will be resolved when Substrate updates their dependencies
    "RUSTSEC-2024-0388",

    # paste 1.0.15 unmaintained (RUSTSEC-2024-0436)
    # ------------------------------------------------
    # Source: sp-core, sp-runtime -> paste
    # Type: Token pasting macro utility
    # Risk: None - no security vulnerabilities
    # Note: Transitive dependency from Substrate/Polkadot SDK
    # Alternative: pastey (fork) available, but requires Substrate update
    # Mitigation: Will be resolved when Substrate updates to pastey or alternative
    "RUSTSEC-2024-0436",

    # lru 0.12.5, 0.13.0 unsound IterMut (RUSTSEC-2026-0002)
    # ------------------------------------------------
    # Source: subxt-lightclient -> smoldot-light -> lru 0.12.5
    #         alloy-provider -> lru 0.13.0
    # Issue: IterMut violates Stacked Borrows by invalidating internal pointer
    # Risk Assessment: LOW
    #   - Unsound behavior but not directly exploitable in typical usage
    #   - Transitive dependency through subxt and alloy ecosystems
    #   - Would require very specific usage patterns to trigger
    # Mitigation Plan:
    #   - Short-term: Monitoring for upstream updates
    #   - Tracking: Waiting for subxt 0.45+ and alloy 2.0+ releases
    #   - Long-term: Will update when dependencies use fixed lru versions
    # Tracking: https://rustsec.org/advisories/RUSTSEC-2026-0002
    "RUSTSEC-2026-0002",
]

[database]
# Fetch advisory database from RustSec
url = "https://github.com/RustSec/advisory-db.git"
path = "~/.cargo/advisory-db"
stale = false
